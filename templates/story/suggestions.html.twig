{% extends 'base.html.twig' %}

{% block title %}Recommandations{% endblock %}

{% block body %}

<section id="detailStory">
    <h1>{{story.name}}</h1>
    <main class="width100 flex flexDirectionRow">
        <img src="{{ asset('uploads/story/' ~ story.cover) }}" class="cover" alt="image de couverture">
        
        <div class="right">
            {# c'est la navbar de droite #}
            <nav class="textCenter width100 flex flexDirectionRow">
                <a href="{{path('detail_story', {'id' : story.id})}}" class="textBlack">Description</a>
                <a href="{{path('chapterForStory', {'idStory': story.id})}}" class="textBlack">Chapitres</a>
                <a href="{{path('suggestions_story', {'idStory': story.id})}}" class="textBlack"><b>Recommandations</b></a>
            </nav>

            {# je parcours les catégories de l'histoire #}
            {% for category in story.categories %}
                <h2> {{category.name}} :</h2>
                {# si la catégories à plus de 5 histoire je limite au 5 première histoires #}
                {% if category.stories | length >5 %}
                    {% set counter = 1 %}
                    {% if counter >=5 %}
                        <div class="right stories flex flexDirectionRow">

                            {% for story in category.stories %}
                            <div class="story textCenter">
                                <img src="{{ asset('uploads/story/' ~ story.cover) }}" alt="couverture de {{story.name}}">
                                <p class="textBlack">{{story.name}}</p>
                                <a class="bouton backgroundPurple textBlack" href="{{path('detail_story', {'id' : story.id})}}">Voir plus <i class="fa-solid fa-arrow-right"></i></a>
                                <p class="summary backgroundWhite">{{story.summary}}</p>
                            </div>
                            {% set counter = counter + 1 %}
                            {% endfor %}
                        </div>
                    {% endif %}
                {# sinon j'affiche tout #}
                {% else %}
                    <div class="right stories flex flexDirectionRow">
                        {% for story in category.stories %}
                            <div class="story textCenter">
                                <img src="{{ asset('uploads/story/' ~ story.cover) }}" alt="couverture de {{story.name}}">
                                <p class="textBlack">{{story.name}}</p>
                                <a class="bouton backgroundPurple textBlack" href="{{path('detail_story', {'id' : story.id})}}">Voir plus <i class="fa-solid fa-arrow-right"></i></a>
                                <p class="summary backgroundWhite">{{story.summary}}</p>

                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endfor %}
    </main>
</section>
{% endblock %}
